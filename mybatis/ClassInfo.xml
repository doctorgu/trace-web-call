<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ClassInfo">
  <select id="selectClassInfo">
    select  classPath
    from    ClassInfo
    where   classPath = #{classPath}
  </select>

  <select id="selectHeaderInfo">
    select  name, implementsName, extendsName, mapping
    from    HeaderInfo
    where   classPath = #{classPath}
  </select>

  <select id="selectMethodInfo">
    select  mapping, isPublic, name, callers, parameterCount
    from    MethodInfo
    where   classPath = #{classPath}
  </select>

  <select id="selectMethodInfoFindByClassPathClassName">
    select  classPath, className, implementsName, extendsName, mappingValues, isPublic, name, parameterCount, callers
    from    MethodInfoFind
    where   filePostfix = #{filePostfix}
            and classPath like #{classPathLike} || '%'
    <if test="fileNameWildcard != null and fileNameWildcard != ''">
            and testWildcardFileName(#{fileNameWildcard}, className || '.java', 1) = 1
    </if>
    <if test="fileNamePattern != null and fileNamePattern != ''">
            and className || '.java' regexp #{fileNamePattern}
    </if>
  </select>

  <select id="selectMethodInfoFindByNameParameterCount">
    select  classPath, className, implementsName, extendsName, mappingValues, isPublic, name, parameterCount, callers
    from    MethodInfoFind
    where   filePostfix = #{filePostfix}
            and name = #{methodName}
            and parameterCount = #{callerParameterCount}
            and
            <foreach collection="classPathsLike" item="classPathLike" separator="or" open="(" close=")">
            classPath like #{classPathLike} || '%'
            </foreach>
    <if test="typeName != null and typeName != ''">
            and (className = #{typeName} or implementsName = #{typeName})
    </if>
    <if test="typeName == null or typeName == ''">
            and className = #{classNameThis}
    </if>
  </select>
</mapper>